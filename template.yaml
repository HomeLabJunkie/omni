kind: Cluster
name: k8s-talos-cluster
labels:
  template: true
  cni: none
  kubespan: enabled
kubernetes:
  version: v1.32.2
talos:
  version: v1.9.4
features:
  enableWorkloadProxy: true
  
patches:
  - name: enable-workload-on-cp
    file: patches/enable-workload-on-cp.yml
  - name: kubespan-enabled
    file: patches/kubespan.yml
  - name: no-cni # we will install cilium in extraManifests
    file: patches/cni.yml
  - name: disable-kubeproxy
    file: patches/disable-kubeproxy.yml
  - name: install-cilium
    file: patches/extraManifests.yml
  - name: metric-server
    file: patches/metrics-server.yml

systemExtensions:
  - siderolabs/iscsi-tools
  - siderolabs/util-linux-tools
---
kind: ControlPlane
machines:
  - 5b7675ab-9294-23a3-0f18-742476129205
  - c12b8cf7-6e73-24c9-308b-3c6689f59028
  - fa99331d-c64b-42c0-878e-5497be58bf7f
---
kind: Workers
machines:
  - 5aa03ceb-d97e-6b59-d293-9c1708fadaa8
  - 6680f42c-8187-0cac-dc4c-4f836fe99873
  - 8ce140e0-700a-6760-eb28-274c903327ef
---
kind: Machine
name: 5aa03ceb-d97e-6b59-d293-9c1708fadaa8
---
kind: Machine
name: 5b7675ab-9294-23a3-0f18-742476129205
---
kind: Machine
name: 6680f42c-8187-0cac-dc4c-4f836fe99873
---
kind: Machine
name: 8ce140e0-700a-6760-eb28-274c903327ef
---
kind: Machine
name: c12b8cf7-6e73-24c9-308b-3c6689f59028
---
kind: Machine
name: fa99331d-c64b-42c0-878e-5497be58bf7f
